(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/newtask/newtask"],{"05e3":function(t,e,a){"use strict";(function(t){a("ab6e"),a("921b");n(a("66fd"));var e=n(a("a407"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"0983":function(t,e,a){"use strict";var n=a("9303"),s=a.n(n);s.a},4705:function(t,e,a){"use strict";a.r(e);var n=a("cc0f"),s=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=s.a},"76a1":function(t,e,a){"use strict";var n,s=function(){var t=this,e=t.$createElement;t._self._c},o=[];a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}))},9303:function(t,e,a){},a407:function(t,e,a){"use strict";a.r(e);var n=a("76a1"),s=a("4705");for(var o in s)"default"!==o&&function(t){a.d(e,t,(function(){return s[t]}))}(o);a("0983");var i,c=a("f0c5"),r=Object(c["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],i);e["default"]=r.exports},cc0f:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a("4122"));function s(t){return t&&t.__esModule?t:{default:t}}var o=function(){a.e("pages/loading/loading").then(function(){return resolve(a("d1da"))}.bind(null,a)).catch(a.oe)},i={components:{Loadings:o},data:function(){var t=this.getDate({format:!0});return{changeValue:"",rizhi:"",maxLong:-1,Loading:!1,ProjectName:"每日工作",index:"0",startTime:t,date:t,tasktimer:"",array:[{status:1,name:"未开始"},{status:2,name:"进行中"},{status:3,name:"完成"}],name:"",changeID:0,TaskIds:0,TodayChangeTask:!0,addressName:""}},onShow:function(){this.addressName="",console.log("首页展示"),this.Loading=!0,this.getLoaction()},onLoad:function(t){this.name=t.name,console.log(t.name)},methods:{CommitTask:function(){if(""!=this.addressName)if(""!=this.index)if(this.Loading=!0,"change"==this.name){if(""==this.tasktimer)return this.Loading=!1,void wx.showToast({title:"请完善信息",icon:"none"});if(this.changeID>0){var t={status:1*this.index+1,hour:this.tasktimer,info:this.rizhi,address:this.addressName};n.default.getPutData("p/v1/wx/journal/".concat(this.changeID,"/"),t,this.tasklist,this.errtask)}else{var e={status:1*this.index+1,hour:this.tasktimer,info:this.rizhi,taskuser:this.TaskIds,address:this.addressName};n.default.request("p/v1/wx/journal/",e,this.tasklist,this.errtask)}}else{if(""==this.date||""==this.changeValue||""==this.startTime)return void(this.Loading=!1);var a={status:1*this.index+1,plan_start_time:this.startTime,plan_end_time:this.date,name:this.changeValue,address:this.addressName};n.default.request("p/v2/wx/task/",a,this.tasklist,this.errtask)}else wx.showToast({title:"请完善信息",icon:"none"});else wx.showToast({title:"请先获取位置",icon:"none"})},tasklist:function(e){this.Loading=!1,console.log(e),200==e.statusCode||201==e.statusCode?(wx.showToast({title:"操作成功",icon:"none"}),t.navigateBack({delta:1})):wx.showToast({title:e.data[0],icon:"none"})},goback:function(){t.navigateBack({delta:1})},change:function(t){console.log(t),this.index=t.target.value},bindDateChangeTwo:function(t){this.startTime=t.target.value,console.log(t.target.value)},bindDateChange:function(t){this.date=t.target.value,console.log(t.target.value)},getDate:function(t){var e=new Date,a=e.getFullYear(),n=e.getMonth()+1,s=e.getDate();return"start"===t?a-=60:"end"===t&&(a+=2),n=n>9?n:"0"+n,s=s>9?s:"0"+s,"".concat(a,"-").concat(n,"-").concat(s)},getLoaction:function(){var e=this,n=this;t.getLocation({type:"gcj02",success:function(e){console.log("用户允许"),console.log(e);var s=a("a27c"),o=new s({key:"TNRBZ-KAZ3W-FLVRN-RMGBB-AR27Z-UEBYG"});o.reverseGeocoder({location:{latitude:e.latitude,longitude:e.longitude},success:function(t){console.log(t),console.log(t.result);var e=t.result.address_component,a=t.result.address_reference.landmark_l2.title;""==e.district?n.addressName=e.province+t.result.formatted_addresses.recommend+a:e.province==e.city?n.addressName=e.city+e.district+e.street_number+a:n.addressName=e.province+e.city+e.district+e.street_number+a,console.log(n.addressName)},fail:function(e){console.log(e),t.showToast({title:"地址解析失败，请点击图标重试",icon:"none",duration:2e3})}})},fail:function(t){console.log("用户拒绝授权，清除位置"),e.openConfirm()},complete:function(){e.Loading=!1}})},openConfirm:function(){wx.showModal({content:"检测到您没打开此小程序的定位权限，是否去设置打开？",confirmText:"确认",cancelText:"取消",success:function(t){console.log(t),t.confirm?(console.log("用户点击确认"),wx.openSetting({success:function(t){}})):console.log("用户点击取消")}})}},computed:{startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate("end")}},mounted:function(){var e=this;t.getStorage({key:"taskid",success:function(a){console.log(a),a.data&&(e.TaskIds=a.data.TaskIds,e.index=(a.data.status-1).toString(),e.changeValue=a.data.task_name,e.ProjectName=a.data.project),t.removeStorage({key:"taskid",success:function(t){console.log("success")}})}}),t.getStorage({key:"info",success:function(a){console.log(a.data),a.data&&(e.ProjectName=a.data.project,e.changeID=a.data.enter.id,e.index=(a.data.enter.status-1).toString(),e.rizhi=a.data.enter.info,e.tasktimer=a.data.enter.hour,e.changeValue=a.data.task_name),t.removeStorage({key:"info",success:function(t){console.log("success")}})}})},watch:{name:function(t,e){}}};e.default=i}).call(this,a("543d")["default"])}},[["05e3","common/runtime","common/vendor"]]]);